FROM oven/bun:1.0 AS runtime
WORKDIR /app

COPY package.json .

RUN bun install

COPY . .
RUN bun run build

ARG BACKEND_URL="https://admin.i2tec.ec"
ENV BACKEND_URL=BACKEND_URL
ENV BACKEND_IMAGE=BACKEND_URL
ENV VITE_BACKEND_URL=BACKEND_URL
ENV VITE_BACKEND_IMAGE=BACKEND_URL

ENV HOST=0.0.0.0
ENV PORT=4321
EXPOSE 4321
CMD ["bun", "./dist/server/entry.mjs"]